function save_image(fname) {
	res = get_integer("Resourcepack resolution\nfor example: 16, 32, 64, 128",16);

    var screen_surf = surface_create(16*res,16*res);

    surface_set_target(screen_surf);
	
	sprite = array_create(256);
	
	var wd = working_directory+"input/textures/blocks/";
	px = res/16;
	
	addpng(0,0,0,"grass_top_carried");
	addpng(1,1,0,"stone");
	addpng(2,2,0,"dirt");
	addpng(3,3,0,"grass_side_carried");
	addpng(4,4,0,"planks_oak");
	addpng(5,5,0,"smooth_stone_slab");
	addpng(6,6,0,"smooth_stone");
	addpng(7,7,0,"brick");
	addpng(8,8,0,"tnt_side");
	addpng(9,9,0,"tnt_top");
	addpng(10,10,0,"tnt_bottom");
	addpng(11,11,0,"web");
	addpng(12,12,0,"flower_rose");
	addpng(13,13,0,"flower_dandelion");
	addpng(13,13,0,"flower_dandelion");
	addpng(14,14,0,"sapling_spruce");
	addpng(15,15,0,"sapling_oak");
	addpng(16,0,1,"cobblestone");
	addpng(17,1,1,"bedrock");
	addpng(18,2,1,"sand");
	addpng(19,3,1,"gravel");
	addpng(20,4,1,"log_oak");
	addpng(21,5,1,"log_oak_top");
	addpng(22,6,1,"iron_block");
	addpng(23,7,1,"gold_block");
	addpng(24,8,1,"diamond_block");
	//sprite 25: chest top 
	//sprite 26: chest side
	//sprite 27: chest front
	addpng(28,12,1,"mushroom_red");
	addpng(29,13,1,"mushroom_brown");
	addpng(30,14,1,"sapling_birch");
	empty(15,1); //31
	addpng(32,0,2,"gold_ore");
	addpng(33,1,2,"iron_ore");
	addpng(34,2,2,"coal_ore");
	addpng(35,3,2,"bookshelf");
	addpng(36,4,2,"cobblestone_mossy");
	addpng(37,5,2,"obsidian");
	addpng(38,6,2,"crying_obsidian");
	addtga(39,7,2,"tall_grass_carried");
	//sprite 40 = chest fucking thing
	addpng(41,9,2,"stonebrick");
	addpng(42,10,2,"stonebrick_cracked");
	addpng(43,11,2,"crafting_table_top");
	addpng(44,12,2,"furnace_front_off");
	addpng(45,13,2,"furnace_side");
	addpng(46,14,2,"dispenser_front_horizontal");
	empty(15,2);
	empty(0,3);
	addpng(49,1,3,"glass");
	addpng(50,2,3,"diamond_ore");
	addpng(51,3,3,"redstone_ore");
	draw_sprite_ext(black,0,4*res,3*res,px*2,px,0,0,1);
	addtga(52,4,3,"leaves_oak_carried");
	addtga(53,5,3,"leaves_oak_carried");
	empty(6,3);
	addpng(55,7,3,"deadbush");
	addtga(56,8,3,"fern_carried");
	addpng(57,9,3,"stonebrick_carved");
	addpng(58,10,3,"stonebrick_mossy");
	addpng(59,11,3,"crafting_table_side");
	addpng(60,12,3,"crafting_table_front");
	addpng(60,13,3,"furnace_front_on");
	addpng(62,14,3,"furnace_top");	
	empty(15,3);
	addpng(64,0,4,"wool_colored_white");
	addpng(65,1,4,"mob_spawner");
	addpng(66,2,4,"snow");
	addpng(67,3,4,"ice");
	addtga(68,4,4,"grass_side_snowed");
	addtga(69,5,4,"cactus_top");
	addtga(70,6,4,"cactus_side");
	addtga(71,7,4,"cactus_bottom");
	addpng(72,8,4,"clay");
	addtga(73,9,4,"reeds");
	addpng(74,10,4,"noteblock");
	addpng(75,11,4,"jukebox_top");
	empty(12,4);
	empty(13,4);
	empty(14,4);
	empty(15,4);
	addpng(80,0,5,"torch_on");
	addpng(81,1,5,"door_wood_upper");
	addpng(82,2,5,"door_iron_upper");
	addpng(83,3,5,"ladder");
	addpng(84,4,5,"trapdoor");
	addpng(85,5,5,"iron_bars");
	addpng(86,6,5,"farmland_wet");
	addpng(87,7,5,"farmland_dry");
	addpng(88,8,5,"wheat_stage_0");
	addpng(89,9,5,"wheat_stage_1");
	addpng(90,10,5,"wheat_stage_2");
	addpng(91,11,5,"wheat_stage_3");
	addpng(92,12,5,"wheat_stage_4");
	addpng(93,13,5,"wheat_stage_5");
	addpng(94,14,5,"wheat_stage_6");
	addpng(95,15,5,"wheat_stage_7");
	addpng(96,0,6,"lever");
	addpng(97,1,6,"door_wood_lower");
	addpng(98,2,6,"door_iron_lower");
	addpng(99,3,6,"redstone_torch_on");
	draw_sprite_ext(black,0,4*res,6*res,px*2,px,0,0,1);
	addtga(100,4,6,"leaves_birch_carried");
	addtga(101,5,6,"leaves_birch_carried");
	addtga(102,6,6,"pumpkin_top");
	empty(7,6);
	empty(8,6);
	empty(9,6);
	addpngext(104,10*res,(6*res)+(8*px),"melon_stem_disconnected",c_green,0,0,16,8,1,1);
	addpngext(105,11*res,(6*res)+(4*px),"melon_stem_disconnected",c_green,0,0,16,12,1,1);
	addpngext(106,12*res,6*res,"melon_stem_disconnected",c_green,0,0,16,16,1,1);
	addpngext(107,13*res,6*res,"melon_stem_connected",c_green,0,0,16,16,1,1);
	addpng(108,14,6,"melon_side");
	addpng(109,15,6,"melon_top");
	addpng(110,0,7,"rail_normal_turned");
	addpng(111,1,7,"wool_colored_black");
	addpng(112,2,7,"wool_colored_gray");
	addpng(113,3,7,"redstone_torch_off");
	addpng(114,4,7,"log_spruce");
	addpng(115,5,7,"log_birch");
	addpng(116,6,7,"pumpkin_side");
	addpng(117,7,7,"pumpkin_face_off");
	addpng(118,8,7,"pumpkin_face_on");
	addpng(119,9,7,"cake_top");
	addpng(120,10,7,"cake_side");
	addpng(121,11,7,"cake_inner");
	addpng(122,12,7,"cake_bottom");
	addpngext(123,14*res,7*res,"melon_stem_connected",c_green,0,0,16,16,-1,1);
	empty(14,7);
	empty(15,7);
	addpng(126,0,8,"rail_normal");
	addpng(127,1,8,"wool_colored_red");
	addpng(128,2,8,"wool_colored_pink");
	addpng(129,3,8,"repeater_off");
	draw_sprite_ext(black,0,4*res,8*res,px*2,px,0,0,1);
	addpng(130,4,8,"leaves_spruce_carried");
	addpng(131,5,8,"leaves_spruce_carried");
	addpng(132,6,8,"bed_feet_top");
	addpng(133,7,8,"bed_head_top");
	addpng(134,8,8,"planks_spruce");
	addpng(135,9,8,"planks_birch");
	addpng(136,10,8,"potatoes_stage_0");
	addpng(137,11,8,"potatoes_stage_1");
	addpng(138,12,8,"potatoes_stage_2");
	addpng(139,13,8,"potatoes_stage_3");
	addpng(140,14,8,"carrots_stage_3");
	empty(15,8);
	addpng(142,0,9,"lapis_block");
	addpng(143,1,9,"wool_colored_green");
	addpng(144,2,9,"wool_colored_lime");
	addpng(145,3,9,"repeater_off");
	empty(4,9);
	
    surface_reset_target();

    surface_save(screen_surf,working_directory+"output/"+fname);
	
    surface_free(screen_surf);
	game_end();
}